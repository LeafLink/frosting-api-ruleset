# Document Structure - Pagination
# https://jsonapi.org/format/#fetching-pagination

# all rules in this file MUST have corresponding tests

rules:
  page-query-arguments-name:
    description: "Pagination query param must be page[number|size|cursor]."
    documentationUrl: 'https://jsonapi.org/format/#fetching-pagination'
    message: "{{path}} - {{description}}"
    severity: error
    given: $.paths..get.parameters.[?(@.in === 'query' && @.name.match(/^page.*?/i))].name
    then:
      - function: enumeration
        functionOptions:
          values:
            - page[number]
            - page[size]
            - page[cursor]
  page-query-arguments-integer:
    description: "Pagination query parameters must be integers."
    documentationUrl: 'https://jsonapi.org/format/#fetching-pagination'
    message: "{{path}} - {{description}}"
    severity: error
    given: $.paths..get.parameters.[?(@.in === 'query' && @.name.match(/^page.*?/i))].schema.type
    then:
      - function: enumeration
        functionOptions:
          values:
            - integer
